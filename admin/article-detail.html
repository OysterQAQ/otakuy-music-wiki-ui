<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>编辑文章</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="lib/layui/css/layui.css">
    <link rel="stylesheet" href="css/scroll-bar.css">
    <link rel="stylesheet" href="css/sub-page.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_693759_wytlyqhtdtj1nhfr.css">
    <style type="text/css">
        .text {
            font-size: 20px;
            line-height: 36px
        }
    </style>
</head>
<body>
<div class="ok-body">
    <!--form表单-->
    <form class="layui-form ok-form">
        <div class="layui-form-item">
            <label class="layui-form-label">标题</label>
            <div class="layui-input-block">
                <div class="text" id="title"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">艺术家</label>
            <div class="layui-input-block">
                <div class="text" id="artists"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">简介</label>
            <div class="layui-input-block">
                <div class="text" style="font-size: 20px;line-height: 20px" id="intro"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">曲目</label>
            <div class="layui-input-block">
                <div class="text" id="tracks"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">标签</label>
            <div class="layui-input-block">
                <div class="text" id="tags"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">下载资源</label>
            <div class="layui-input-block">
                <div class="text" id="downloadRes"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">流派</label>
            <div class="layui-input-block">
                <div class="text" id="genres"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">专辑类型</label>
            <div class="layui-input-block">
                <div class="text" id="version"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">发行时间</label>
            <div class="layui-input-block">
                <div class="text" id="pubdate"></div>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">发行商</label>
            <div class="layui-input-block">
                <div class="text" id="publisher"></div>
            </div>
        </div>
    </form>
</div>
<!--js逻辑-->
<script type="text/javascript" src="../src/js/jq.js"></script>
<script>
    console.log(GetQueryString('album'))

    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }

    function getAlbumDetail(album) {
        jQuery.ajax({
            type: "GET",
            headers: {
                Authorization: 'Bearer eyJhbGciOiJIUzUxMiJ9.eyJyb2xlIjpbIlJPTEVfVVNFUiIsIlJPTEVfQURNSU4iXSwiaWQiOiI1YzcxMzk2OGU4NmMyYzAyMjRiNWFjMTAiLCJ1c2VybmFtZSI6IueUn-ianVFBUSIsInN1YiI6IueUn-ianVFBUSIsImlhdCI6MTU1MjAxMzMyMCwiZXhwIjoxNTUyODc3MzIwfQ.JFLg-sMiud9IYrLYO4UiD8ajn_x8lOs6mnN46iU0iZFiSRo7tlp1MJalwpkDtDYmX6IUXau93EkUTBpoptE5mQ'
            },
            url: 'http://127.0.0.1/admin/albums/' + album,
            contentType: 'application/json',//typically 'application/x-www-form-urlencoded', but the service you are calling may expect 'text/json'... chec
            success: function (data, textStatus, request) {
                console.log(data)
                data = data.data;
                var tracks = '';
                $.each(data.tracks, function (index, element) {
                    tracks += (index + 1) + '. ' + element.title + '<br>';
                });
                var tags = '';
                $.each(data.tags, function (index, element) {
                    tags += element.name + '&nbsp;&nbsp;';
                });
                var artists = '';
                $.each(data.artists, function (index, element) {
                    tags += element.name + '&nbsp;&nbsp;';
                });
                $('#artists').html(artists);
                $('#title').html(data.title);
                $('#intro').html(data.intro);
                $('#downloadRes').html(JSON.stringify(data.downloadRes));
                $('#genres').html(data.genres);
                $('#tracks').html(tracks);
                $('#tags').html(tags);
                $('#version').html(data.version);
                $('#pubdate').html(data.pubdate);
                $('#publisher').html(data.publisher);
            },
            error: function (data, textStatus, request) {
            }
        });
    }

    getAlbumDetail(GetQueryString('album'))

</script>
</body>
</html>